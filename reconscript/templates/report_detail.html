{% extends 'layout.html' %}
{% block content %}
  <div class="card">
    <h2>Report {{ report_id|e }}</h2>
    <p><strong>Target:</strong> {{ report.target|e }}</p>
    <p><strong>Evidence level:</strong> {{ report.evidence_level|e }}</p>
    <p><strong>Report hash:</strong> {{ report.report_hash|e }}</p>
    {% if report.consent_signed_by %}
      <p><strong>Consent signer:</strong> {{ report.consent_signed_by|e }}</p>
    {% endif %}
    <p><strong>Started:</strong> {{ report.started_at|e }} | <strong>Completed:</strong> {{ report.completed_at|e }}</p>
    <h3>Open ports</h3>
    <ul>
      {% for port in report.open_ports %}
        <li>{{ port|e }}</li>
      {% else %}
        <li>No open ports detected.</li>
      {% endfor %}
    </ul>
    <h3>HTTP Checks</h3>
    <pre style="white-space:pre-wrap;background:#0b121b;padding:1rem;border-radius:6px;">{{ report.http_checks | tojson(indent=2) }}</pre>
    <h3>Findings</h3>
    <pre style="white-space:pre-wrap;background:#0b121b;padding:1rem;border-radius:6px;">{{ report.findings | tojson(indent=2) }}</pre>
    <p style="margin-top:1rem;"><a href="{{ url_for('download_result', filename=report_id + '/report.json') }}">Download report JSON</a></p>
  </div>
{% endblock %}
