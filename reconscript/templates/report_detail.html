
<!-- Authorized testing only â€” do not scan targets without explicit permission. This tool is non-intrusive by default and will not perform exploitation or credentialed checks. -->
{% extends 'layout.html' %}
{% block content %}
  <div class="card">
    <h2>Report {{ report_id }}</h2>
    <p><strong>Target:</strong> {{ report.metadata.target }}</p>
    <p><strong>Resolved:</strong> {{ report.metadata.resolved_target }}</p>
    <p><strong>Evidence level:</strong> {{ report.metadata.evidence_level }}</p>
    <p><strong>Profile:</strong> {{ report.metadata.profile.name }} (TCP max {{ report.metadata.profile.max_tcp_ports }}, concurrency {{ report.metadata.profile.tcp_concurrency }})</p>
    <p><strong>Authorization confirmed:</strong> {{ 'yes' if report.metadata.consent_present else 'no' }}</p>
    <p><strong>Started:</strong> {{ report.started_at }} | <strong>Completed:</strong> {{ report.completed_at }}</p>
    <p><strong>Scanned TCP ports:</strong> {{ report.metadata.scanned_tcp_ports|join(', ') }}</p>
    <p><strong>Scanned UDP ports:</strong> {{ report.metadata.scanned_udp_ports|join(', ') }}</p>

    <h3>Artifacts</h3>
    <pre style="white-space:pre-wrap;background:#0b121b;padding:1rem;border-radius:6px;">{{ report.artifacts | tojson(indent=2) }}</pre>

    <h3>Findings</h3>
    {% if report.findings %}
      <ul class="findings">
        {% for finding in report.findings %}
          <li>
            <div class="finding-header">
              <strong>{{ finding.summary }}</strong>
              <span class="tag">{{ finding.tool }}</span>
            </div>
            <p><strong>Command:</strong> <code>{{ finding.cmdline }}</code></p>
            <p><strong>Started:</strong> {{ finding.started_at }} | <strong>Completed:</strong> {{ finding.completed_at }}</p>
            <details>
              <summary>View raw snippet</summary>
              <pre style="white-space:pre-wrap;background:#0b121b;padding:1rem;border-radius:6px;">{{ finding.raw_snippet }}</pre>
            </details>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No findings recorded.</p>
    {% endif %}

    <p style="margin-top:1rem;"><a href="{{ url_for('download_result', filename=report_id + '/report.json') }}">Download report JSON</a></p>
  </div>
{% endblock %}
