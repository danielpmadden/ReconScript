{% extends 'layout.html' %}
{% block content %}
  <div class="card">
    <h2>Launch Scoped Scan</h2>
    <p>All scans are read-only and respect signed consent manifests. Targets outside localhost require a validated manifest before scanning.</p>
    <form method="post" enctype="multipart/form-data" id="scan-form">
      <label for="target">Target IP or hostname</label>
      <input type="text" id="target" name="target" required placeholder="127.0.0.1" />

      <label for="expected_ip">Expected IP (optional for hostnames)</label>
      <input type="text" id="expected_ip" name="expected_ip" placeholder="Optional expected IP" />

      <label for="hostname">HTTP Host header override</label>
      <input type="text" id="hostname" name="hostname" placeholder="Optional hostname" />

      <label for="ports">Ports (comma separated)</label>
      <input type="text" id="ports" name="ports" placeholder="80,443,8080" />

      <label for="evidence_level">Evidence level</label>
      <select id="evidence_level" name="evidence_level">
        <option value="low">Low - headers and metadata only</option>
        <option value="medium">Medium - headers and artefacts</option>
        <option value="high">High - full request/response logs (requires manifest)</option>
      </select>

      <label for="consent_file">Signed consent manifest (.json)</label>
      <input type="file" id="consent_file" name="consent_file" accept="application/json" aria-describedby="consent-help" />
      <div style="margin-top:0.5rem;">
        <input type="checkbox" id="consent_confirm" aria-describedby="consent-help" />
        <label for="consent_confirm" style="display:inline; font-weight:400;">I confirm this manifest authorises the requested scope.</label>
      </div>

      <button type="submit" id="submit-btn" disabled>Run Scan</button>
    </form>
    <p id="consent-help" style="margin-top:1rem; font-size:0.9rem;">
      Need a manifest? Use <code>scripts/generate_scope_manifest.py</code> and have the asset owner sign it.
    </p>
  </div>
{% endblock %}
