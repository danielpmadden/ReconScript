{% extends "layout.html" %}

{% block title %}Past Reports — ReconScript Dashboard{% endblock %}

{% block content %}
<section class="space-y-8">
  <div class="flex items-center justify-between">
    <h1 class="text-3xl font-semibold text-sky-200 flex items-center gap-3">
      <span>📚</span>
      Past Reports
    </h1>
    <a href="{{ url_for('dashboard') }}" class="inline-flex items-center gap-2 rounded-full border border-slate-700 px-5 py-2 text-sm font-semibold text-slate-200 transition hover:border-sky-400 hover:text-sky-200">
      ← Back to Dashboard
    </a>
  </div>

  {% if reports %}
  <div class="surface overflow-hidden rounded-2xl border border-slate-800 bg-slate-900/60 shadow-xl">
    <table class="min-w-full divide-y divide-slate-800">
      <thead class="bg-slate-900/80 text-xs uppercase tracking-wide text-slate-400">
        <tr>
          <th scope="col" class="px-6 py-3 text-left">Filename</th>
          <th scope="col" class="px-6 py-3 text-left">Saved</th>
          <th scope="col" class="px-6 py-3 text-left">Type</th>
          <th scope="col" class="px-6 py-3 text-right">Size</th>
          <th scope="col" class="px-6 py-3 text-right">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-800 text-sm text-slate-200">
        {% for report in reports %}
        <tr class="hover:bg-slate-800/40 transition">
          <td class="px-6 py-4">
            <a href="{{ report.url|e }}" target="_blank" rel="noopener" class="font-semibold text-sky-300 hover:text-sky-200">
              {{ report.name|e }}
            </a>
          </td>
          <td class="px-6 py-4 text-slate-300">{{ report.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
          <td class="px-6 py-4">
              <span class="inline-flex items-center gap-2 rounded-full border border-slate-700 bg-slate-950/60 px-3 py-1 text-xs font-semibold text-slate-200">
              <span>🗂️</span>{{ report.type|e }}
            </span>
          </td>
          <td class="px-6 py-4 text-right text-slate-400">{{ (report.size / 1024)|round(1) }} KB</td>
          <td class="px-6 py-4 text-right">
            <div class="flex items-center justify-end gap-2">
              <a href="{{ report.folder|e }}" class="inline-flex items-center gap-1 rounded-full border border-slate-700 px-3 py-1 text-xs font-semibold text-slate-300 hover:border-sky-400 hover:text-sky-200" target="_blank" rel="noopener">📂 Open Folder</a>
              <form method="post" action="{{ url_for('delete_report', filename=report.name) }}" onsubmit="return confirm('Delete {{ report.name|e }}?');">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
                <button type="submit" class="inline-flex items-center gap-1 rounded-full border border-rose-600/60 px-3 py-1 text-xs font-semibold text-rose-200 hover:border-rose-500 hover:text-rose-100">🗑️ Delete</button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="surface rounded-2xl border border-dashed border-slate-700 bg-slate-900/40 p-12 text-center text-slate-400">
    <p class="text-xl font-medium">No reports yet.</p>
    <p class="mt-2 text-sm">Run your first scan from the dashboard to generate a report.</p>
  </div>
  {% endif %}
</section>
{% endblock %}
